ITERATION 08 — SQLite schema v1 + migrations + repository layer
SUBAGENTS: journalink-db (lead), journalink-architect (support), journalink-qa (support)

PRIMARY GOAL
Implement the minimal DB schema for JournalLink’s local-first vault + emergent tags + swipe records + job queue, using migrations/versioning.

PREFLIGHT
1) Inspect current DB usage (expo-sqlite or other). Identify where DB init happens.
2) Confirm there is one DB access module (no scattered openDatabase calls).
3) Ensure schema changes are migration-based (no manual SQL in random screens).

DB TABLES (CREATE IF NOT EXISTS)
- items(id, kind, title, url, text, mime, created_at, updated_at)
- media_meta(item_id, duration_ms, width, height, exif_json, ocr_status, asr_status, source_domain, extra_json)
- jobs(id, kind, status, payload_json, progress, error, created_at, updated_at)
- tags(id TEXT PK, name, slug UNIQUE, kind, created_at, updated_at)  // kind: emergent|manual|system
- tag_assignments(item_id, tag_id, score REAL, source, created_at)
- swipe_media(id, title, type, image_url, short_desc, long_desc, source, tags_json, popularity_score, created_at)
- swipe_sessions(id, started_at, ended_at, filters_json)
- swipe_events(id, session_id, media_id, decision, strength, created_at)
- session_ledger(id, started_at, mode, provider, excerpt_counts_json, sensitive_included, token_estimate, cost_estimate_cents)

IMPLEMENTATION TASKS
A) Add migrations framework:
   - track PRAGMA user_version
   - migrateDbIfNeeded(db) called exactly once during app boot
B) Add repository modules:
   - repositories/itemsRepo.ts
   - repositories/tagsRepo.ts
   - repositories/jobsRepo.ts
   - repositories/swipeRepo.ts
C) Add typed models in a single place (types/db.ts) and ensure all repos use them.

QA / TESTS
- Add a lightweight migration test or “smoke test” screen/dev command that:
  - opens DB
  - runs migrate
  - inserts a sample item + tag + assignment
  - reads them back

DELIVERABLES
- Migrations in place, schema created, repos exist.
- Commit: "iter08: sqlite schema v1 + migrations + repos"
